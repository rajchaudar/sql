CREATE TABLE PUBLISHER (
    PID INT PRIMARY KEY,
    PNAME VARCHAR(50),
    ADDRESS VARCHAR(100),
    STATE VARCHAR(50),
    PHONE VARCHAR(15),
    EMAILID VARCHAR(50)
);

CREATE TABLE BOOK (
    ISBN INT PRIMARY KEY,
    BOOK_TITLE VARCHAR(100),
    CATEGORY VARCHAR(50),
    PRICE DECIMAL(10, 2),
    COPYRIGHT_DATE DATE,
    YEAR INT,
    PAGE_COUNT INT,
    PID INT,
    FOREIGN KEY (PID) REFERENCES PUBLISHER(PID)
);

CREATE TABLE AUTHOR (
    AID INT PRIMARY KEY,
    ANAME VARCHAR(50),
    STATE VARCHAR(50),
    CITY VARCHAR(50),
    ZIP VARCHAR(10),
    PHONE VARCHAR(15),
    URL VARCHAR(100)
);

CREATE TABLE AUTHOR_BOOK (
    AID INT,
    ISBN INT,
    PRIMARY KEY (AID, ISBN),
    FOREIGN KEY (AID) REFERENCES AUTHOR(AID),
    FOREIGN KEY (ISBN) REFERENCES BOOK(ISBN)
);

CREATE TABLE REVIEW (
    RID INT PRIMARY KEY,
    ISBN INT,
    RATING INT,
    FOREIGN KEY (ISBN) REFERENCES BOOK(ISBN)
);


-- Sample Publishers
INSERT INTO PUBLISHER VALUES (1, 'MEHTA', 'Address1', 'State1', '9876543210', 'mehta@example.com');
INSERT INTO PUBLISHER VALUES (2, 'PEARSON', 'Address2', 'State2', '8765432109', 'pearson@example.com');

-- Sample Books
INSERT INTO BOOK VALUES (101, 'Book1', 'Fiction', 500, '2021-01-01', 2021, 150, 1);
INSERT INTO BOOK VALUES (102, 'Book2', 'Non-Fiction', 300, '2022-01-01', 2022, 90, 1);

-- Sample Authors
INSERT INTO AUTHOR VALUES (201, 'CHETAN BHAGAT', 'Maharashtra', 'Mumbai', '400001', '1234567890', 'chetan.com');
INSERT INTO AUTHOR VALUES (202, 'Korth', 'Maharashtra', 'Pune', '411001', '0987654321', 'korth.com');

-- Sample Author-Book
INSERT INTO AUTHOR_BOOK VALUES (201, 101);
INSERT INTO AUTHOR_BOOK VALUES (202, 102);

-- Sample Review
INSERT INTO REVIEW VALUES (1, 101, 5);
INSERT INTO REVIEW VALUES (2, 102, 4);


SELECT CITY, PHONE, URL 
FROM AUTHOR 
WHERE ANAME = 'CHETAN BHAGAT';


SELECT BOOK.BOOK_TITLE, REVIEW.RID, REVIEW.RATING
FROM BOOK
JOIN REVIEW ON BOOK.ISBN = REVIEW.ISBN;


SELECT BOOK.BOOK_TITLE, BOOK.PRICE, AUTHOR.ANAME, AUTHOR.URL
FROM BOOK
JOIN PUBLISHER ON BOOK.PID = PUBLISHER.PID
JOIN AUTHOR_BOOK ON BOOK.ISBN = AUTHOR_BOOK.ISBN
JOIN AUTHOR ON AUTHOR_BOOK.AID = AUTHOR.AID
WHERE PUBLISHER.PNAME = 'MEHTA';


UPDATE PUBLISHER 
SET PHONE = '123456' 
WHERE PNAME = 'MEHTA';


SELECT PUBLISHER.PNAME, 
       AVG(BOOK.PRICE) AS Average_Price, 
       MAX(BOOK.PRICE) AS Maximum_Price, 
       MIN(BOOK.PRICE) AS Minimum_Price
FROM BOOK
JOIN PUBLISHER ON BOOK.PID = PUBLISHER.PID
GROUP BY PUBLISHER.PNAME;


DELETE FROM BOOK 
WHERE PAGE_COUNT < 100;


SELECT * 
FROM AUTHOR 
WHERE CITY = 'Pune' AND ANAME LIKE 'C%';


SELECT * 
FROM AUTHOR 
WHERE CITY = (SELECT CITY FROM AUTHOR WHERE ANAME = 'Korth');
